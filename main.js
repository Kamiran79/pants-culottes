const pants01 = [{
    id: 00,
    name: "Georgette Wide-Leg Pants St John Collection",
    nameD: "St John Collection georgette layered pants",
    price: 150.00,
    model: "History Culotte",
    size: [2, 4, 6],
    imgUrl: [{
      color: "black",
      url: "https://images.neimanmarcus.com/ca/6/product_assets/B/2/Z/D/Q/NMB2ZDQ_mz.jpg"
    }],
    disc: "St John Collection georgette layered pants. Banded waist. Wide relaxed-fit legs.",
    productURL: "https://www.neimanmarcus.com/p/st-john-collection-georgette-wide-leg-pants-prod179760472",

  },
  {
    id: 01,
    name: "G-Star RAW Women High Waist Culotte Sweatpants",
    nameD: "",
    price: 130.00,
    model: "Fashion Culotte",
    size: [8],
    imgUrl: [{
        color: "Grey",
        url: "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQcMmej_GtcHOLlhwagZ2HzPqtkoXLrp089HdagzwnI0qszQsBDMLXcqq-4RZjWOrSx2SltJU4&usqp=CAc"
      },
      {
        color: "Beige",
        url: "https://img1.g-star.com/product/c_fill,f_auto,h_675,q_80/v1583927558/D17299-C332-B436-Z01W/g-star-raw-high-waist-culotte-sweatpants-pink.jpg"
      }
    ],
    disc: "A broad elasticated waist offers an integrated drawstring. The High Waist Culotte sweatpants is designed in a wide flared fit and a high waist. Inset pockets are added. The leghems show a raw edge finish.",
    productURL: "https://www.g-star.com/en_us/shop/women/pants/d17299-c332-b436",

  },
  {
    id: 02,
    name: "Floral-Print Silk Twill Cropped Pajama Culottes",
    nameD: "Gucci",
    price: 1500.00,
    model: "Fashion Culotte",
    size: [4, 6],
    imgUrl: [{
        color: "Bisque",

        url: "https://encrypted-tbn0.gstatic.com/images?q=tbn%3AANd9GcQjqy_G8BxwPDP0rgUXnQAZiN3TdhX4n3N06VFYtTLHMWORuSBw50xZUa245OcOTVEyikwAValJ&usqp=CAc"
      },

    ],
    disc: "Floral-print silk twill pajama culottes. Wide legs. Relaxed fit. Knee-length. made in Italy.",
    productURL: "https://www.neimanmarcus.com/p/gucci-floral-print-silk-twill-cropped-pajama-culottes-prod211240215?utm_source=google_shopping&adpos=&scid=scplpsku179331122&sc_intid=sku179331122&ecid=NMCS__GooglePLA&gclid=Cj0KCQjw2PP1BRCiARIsAEqv-pRhK4SBzlvxuhAyJf3rIR5arB39tLsI9qxcAXFFg558Xic5mQ5836EaAjDAEALw_wcB&gclsrc=aw.ds",

  },
  {
    id: 03,
    name: "Brooklyn Wide Leg Crop Pant",
    nameD: "Gucci",
    price: 89.00,
    model: "Fashion Culotte",
    size: [2, 4, 6, 8],
    imgUrl: [{
        color: "Maroon",
        url: "https://www1.assets-gap.com/webcontent/0018/546/878/cn18546878.jpg",
      },
      {
        color: "Black",
        url: "https://www1.assets-gap.com/webcontent/0018/546/959/cn18546959.jpg",
      },
      {
        color: "Bisque",
        url: "https://www1.assets-gap.com/webcontent/0018/563/919/cn18563919.jpg",
      },
      {
        color: "Navy",
        url: "https://www1.assets-gap.com/webcontent/0018/717/333/cn18717333.jpg",
      },
    ],
    disc: "FIT: Semi-fitted, skims easily over the body with a mid-rise waistband. FOR: Commuting, work and travel. FEEL: Featherweight Stretchâ„¢ fabric made with recycled polyester feels silky sleek and light as air. FAVE: Five pockets; 2 front hand, 3 secure zip.",
    productURL: "https://www.neimanmarcus.com/p/gucci-floral-print-silk-twill-cropped-pajama-culottes-prod211240215?utm_source=google_shopping&adpos=&scid=scplpsku179331122&sc_intid=sku179331122&ecid=NMCS__GooglePLA&gclid=Cj0KCQjw2PP1BRCiARIsAEqv-pRhK4SBzlvxuhAyJf3rIR5arB39tLsI9qxcAXFFg558Xic5mQ5836EaAjDAEALw_wcB&gclsrc=aw.ds",

  },
  {
    id: 04,
    name: "Summer Women's Skirt Pant Ruffle Palazzo",
    nameD: "Summer Women's Skirt Pant Ruffle Palazzo Trouser Boho Wide Leg Loose Skirt Pants",
    price: 20.00,
    model: "Fashion Culotte",
    size: [2, 4, 6, 8, 10],
    imgUrl: [{
        color: "grey",
        url: "https://contestimg.wish.com/api/webimage/5da51719eac01d008ff95556-2-large",
      },
      {
        color: "Black",
        url: "https://contestimg.wish.com/api/webimage/5da51719eac01d008ff95556-6-large",
      },
      {
        color: "red",
        url: "https://contestimg.wish.com/api/webimage/5da51719eac01d008ff95556-7-large",
      },
      {
        color: "Navy",
        url: "https://contestimg.wish.com/api/webimage/5da51719eac01d008ff95556-5-large",
      },
    ],
    disc: "Summer Women's Skirt Pant Ruffle Palazzo Trouser Boho Wide Leg Loose Skirt Pants.",
    productURL: "https://www.wish.com/product/5da51719eac01d008ff95556?hide_login_modal=true&from_ad=goog_shopping&_display_country_code=US&_force_currency_code=USD&pid=googleadwords_int&c=%7BcampaignId%7D&ad_cid=5da51719eac01d008ff95556&ad_cc=US&ad_curr=USD&ad_price=20.20&campaign_id=7203534630&gclid=Cj0KCQjw2PP1BRCiARIsAEqv-pQfIP3C7d-oXir5J0FahSbNe1g-BW0fK5lK6kbqaIB38Ycpc_HocrkaAquXEALw_wcB&share=web",
  },

];

const articles = [{
    headline: "J-Law in Flowy Culottes",
    articleImage: 'https://bit.ly/2WKKlbi',
    publishDate: '01/15/20',
    articleURL: 'https://bit.ly/2WqQZod',
  },
  {
    headline: "Mila Kunis in Wide-Leg Pants",
    articleImage: 'https://bit.ly/3dGj8gC',
    publishDate: '12/10/19',
    articleURL: 'https://bit.ly/2WT6m7F',
  },
  {
    headline: "Kate Middleton repping the 'lottes",
    articleImage: 'https://bit.ly/2YWXmBl',
    publishDate: '10/10/19',
    articleURL: 'https://bit.ly/2LpD3UY',
  },
];

const printToDom = (selector, textToPrint) => {
  const selectedDiv = document.querySelector(selector);
  if (selectedDiv === null) return;
  selectedDiv.innerHTML = textToPrint;
}

const getImageURLs = (arr) => {
  let imgURLs = [];

  // Get all possible image URLs
  arr.forEach(pants => {
    pants.imgUrl.forEach(url => {
      imgURLs.push(url.url);
    })
  });

  // From all possible image URLs
  // We will select 10 of those for previewing on the homepage
  let selectedURLs = [];

  for (let i = 0; i < 10; i++) {
    selectedIndex = Math.floor(Math.random() * imgURLs.length);
    selectedURLs.push(imgURLs.splice(selectedIndex, 1));
  }

  return selectedURLs;
}

const previewCardBuilder = (arr) => {

  let domString = '';

  for (let i = 0; i < 10; i++) {

    // Create a row div where required
    if (i == 0 || i == 2 || i == 6) {
      domString += `<div class="row">`;
    }

    // Create the top row bigger cards
    if (i <= 1) {
      domString += `
      <div class="card testcard col-12 col-lg-6 card-primary preview-card">
        <div class="card-body mx-auto">
          <a href="./shopping.html"><img class="card-img preview-card-img" src="${arr[i]}"></a>
        </div>
      </div>
      `;
    }
    // Otherwise, we create the smaller cards
    else {
      domString += `
      <div class="card testcard col-12 col-md-6 col-log-3 preview-card">
        <div class="card-body mx-auto">
          <a href="./shopping.html"><img class="preview-card-img-sm" src="${arr[i]}"></a>
        </div>
      </div>
      `;
    }

    // Ends the row div
    if (i == 1 || i == 5 || i == 9) {
      domString += `</div>`;
    }
  }

  return domString;
};



const articleCardBuilder = (arr) => {
  let domString = '';

  for (let i = 0; i < arr.length; i++) {
    domString += `
    <div class="col-5 mx-auto">
    <div class="card mt-3 testcard">
      <div class="card-body p-2">
        <h5 class="card-title">${arr[i].headline}</h5>
        <p class="card-text testCardText">${arr[i].publishDate}</p>
        <img class="card-img-top" src="${arr[i].articleImage}" alt="">
      </div>
    </div>
    </div>
    `;
  }
  printToDom('#articleCards', domString);
}

// *** Shopping Page Start Below ***

//Build all Product cards
const buildProductCard = (arr) => {
  domString = '';
  for (let i = 0; i < arr.length; i++) {
    domString += `
       <div class="col-6 col-md-3 mb-3">
          <div class="card testcard">
             <div class="card-body p-2">
                <img class="card-img-top adj" src="${arr[i].imgUrl[0].url}" alt="">
                <h6 class="card-title">${arr[i].name}</h6>
                <p class="card-text testCardText">$${arr[i].price}</p>        
                <p class="card-text testCardText">${arr[i].model}</p>
                <a id ="${arr[i].id}" onClick= "detailsCard(this.id)" href="#" class="btn btn-outline-warning btnDetails">Details</a>        
             </div>
           </div>
       </div>
     `;
  }
  printToDom('#allCards', domString);
}

// this variables below for select imgae and color and all apply for shopping page **
let imgSelected = 0;
let cardSelected = 0;
var myDetails;
const shopCart = [];
let tempShopCart = [0];
let validQty = true;
let deleteItem = [];
let cartID = 0;

// build product card details.

const buildProductDetailcard = (arr,x,s) => {
  domString = '';
  tempShopCart[0] = ({
                       id: cartID,
                       name: arr[0].name,
                       nameD: arr[0].nameD,
                       price: arr[0].price,
                       model: arr[0].model,
                       size: arr[0].size[0],
                       imgUrl: arr[0].imgUrl[s].url,
                       color: arr[0].imgUrl[s].color,
                       qty: 1,
                      });
  domString += `
               <div class="col-md-4">
                  <img id="imgDetail" src="${arr[0].imgUrl[s].url}" class="card-img detailsCard" alt="...">
                </div>`;
  domString += `<div class="col-md-8 details">`;
  domString += `<div class="card-body">`;
  domString += `<h3 class="card-title">${arr[0].name}</h3>`;
  domString += `<h6 class="card-text testCardText">${arr[0].nameD}</h6>`;
  domString += `<h6 class="card-text testCardText">$${arr[0].price}</h6>`;
  domString += `<h6 class="card-text testCardText">Color:<span> ${arr[0].imgUrl[s].color}</span></h6>`;
  domString += `<div class ="row">`;
  // this loop to create the color buttons **
  for (let j=0; j< arr[0].imgUrl.length; j++) {            
    domString += `
                 <div class="col-2">
                    <div class="btn-group btn-group-toggle"  data-toggle="buttons">
                        <label class="btn btn-secondary active" style = "background-color:${arr[0].imgUrl[j].color};">
                          <input type="radio" onClick= "changeImgCard(this.id)" name="options" id="${j}" style = "background-color:${arr[0].imgUrl[j].color};" autocomplete="off" checked>
                        </label>
                    </div>                        
                  </div>
                  `;
  }          
  domString += `</div>`;
  domString += `<h6 class="testCardText detailsCard detailsP">US SIZE: <span class="detailsSpan">PLEASE SELECT</span></h6>`;
  domString += `<div class ="row">`;
  // this loop to create the size buttons **
  for (j = 0; j < arr[0].size.length; j++) {
    domString += `
                 <div class="col-2">
                   <div class="btn-group btn-group-toggle"  data-toggle="buttons">
                     <label class="btn btn-secondary active" style = "background-color:Bisque;color:black;">
                       <input type="radio" onClick= "changeSizeCard(this.id)" name="options" id="${j}"  style = "color:black;" autocomplete="off" checked>${arr[0].size[j]}
                     </label>
                    </div>                        
                 </div>
                 `;
  }
  domString += `</div>`;
  domString += `<h6 class="card-text testCardText detailsCard">Style: <span>${arr[0].model}</span> </h6>`;
  domString += `<h6 class="card-text testCardText">QUANTITY:</h6>`;
  domString += `<a id ="${arr[0].id}" onClick= "addToCart(this.id)" href="#" class="btn btn-outline-warning float-right btnDetails">Add To Cart</a>`;
  domString += `<input type="text" maxlength="2" onchange="changeSaveCard(this.value)" value = "1" name="options" class="card-text testCardText" style = "background-color:Bisque;max-width:30px;border-radius:3px;" autocomplete="off" checked>`;
  domString += `<p class ="card-text testCardText" style="color:red;" id="demo"></p>`;
  domString += `<h6 class="card-text testCardText detailsCard">Description:</h6>`;
  domString += `<p class="card-text testCardText"><small class="text-muted">${arr[0].disc}</small></p>`;
  domString += `</div>`;                                                                                                                                                           
  printToDom('#dCards', domString);
}


// To build Cart Items **
const buildCartItems = (arr) => {
  domString = '';
  //console.log(arr);
  for (let i = 0; i < arr.length; i++) {
    console.log(arr[i].imgUrl);
    domString += `
                 <div id="cams" class="row justify-content-md-center testcard mb-3 cartSection">
                   <div class="col-md-1 mb-3 cartSection">
                     <a id ="${arr[i].name}" onClick= "detailsCartCard(this.id)" href="#" ><img src="${arr[i].imgUrl}" class="card-img imgCart" alt="..."></a>                    
                   </div>
                   <div class="col-md-11 cartDetail">
                     <div class="card-body">
                       <h5 class="card-title testCardText">${arr[i].name}</h5>
                       <lu class="card-text testCardText" >
                         <li>Price: $${arr[i].price}</li>
                         <li>Color:<span> ${arr[i].color}</span></li>
                         <li>Size: ${arr[i].size}</li>
                         <li>Quantity: ${arr[i].qty}</li>
                       </lu>          
                     </div>
                     <a id ="${arr[i].id}" onClick= "removeItem(this.id)" href="#" class="btn btn-outline-warning float-right btnRemove">Remove</a>
                   </div>                  
                 </div>
                 `;    
  }                  
  //console.log(domString);
  printToDom('#cartItems', domString);
}

// Validate the input for the quantity and also apply the change **
function changeSaveCard(val) {
  var x, text;
  x = val;
  if (isNaN(x) || x < 1 || x > 99) {
    text = "Input not valid! Please your inpot a number between 1 to 99";
    validQty = false;
    document.getElementById("demo").innerHTML = text;  
  } else {
    validQty = true;
    text = "";
    document.getElementById("demo").innerHTML = text;  
    tempShopCart[0].qty = val;
    console.log(tempShopCart[0].qty);
  }  
  return;
}

// Change the image for the details card if the user select diffrent color if the picture available **
function changeImgCard(clicked) {
  validQty = true;
  var x = Number(clicked);
  imgSelected = x;
  console.log(myDetails);
  cardSelected = 0;
  //tempShopCart[0].imgUrl = myDetails[0].imgUrl[imgSelected].url;
  //tempShopCart[0].color = myDetails[0].imgUrl[imgSelected].color;
  buildProductDetailcard(myDetails,cardSelected,imgSelected);
}

// function for the apply and store the changed size to the temp obj **
function changeSizeCard (clicked) {
  validQty = true;
  var x = Number(clicked); // to convert string to number!!
  tempShopCart[0].size = myDetails[0].size[x];
  return;
}

// function for show hide items.
function myFunctionShow(id) {
  var x = document.getElementById(id);
  if (x.style.display === "none") {
    x.style.display = "block";
  }
}

function myFunctionHide(id) {
  var x = document.getElementById(id);
  if (x.style.display === "block") {
    x.style.display = "none";
  }
}

// This is function to filter and find the correct card then build card details **
function detailsCard(clicked) {
  validQty = true;
  console.log("this is type of number and it is ", clicked);
  var x = Number(clicked);
  myDetails = (pants01.filter(mmod => { return mmod.id === x;}));
  cardSelected = x;
  imgSelected = 0;
  console.log("This is myDetails", myDetails[0]);
  myFunctionShow("details");
  buildProductDetailcard(myDetails, x, imgSelected);
}


// Add selected item to the cart
function addToCart (clicked) {
  var x = Number(clicked);
  //var q = document.getElementById("qty").value;
  //console.log(q);
  var text = '';    
  console.log("this add to cart",tempShopCart[0].qty);
  console.log(shopCart);
  if (validQty === true) {
    //console.log("this qty value: ", shopCart[shopCart.length-1].qty);
    document.getElementById("demo").innerHTML = text;
    shopCart.push(tempShopCart[0]);
    cartID++;
    tempShopCart[0] = ({
      id: cartID,
      name: myDetails[0].name,
      nameD: myDetails[0].nameD,
      price: myDetails[0].price,
      model: myDetails[0].model,
      size: myDetails[0].size[0],
      imgUrl: myDetails[0].imgUrl[imgSelected].url,
      color: myDetails[0].imgUrl[imgSelected].color,
      qty: 1,
     });
  }
  console.log("this qty before that value: ", shopCart[shopCart.length-2].qty);
  return;
}

// Show the details for the item added to the cart
function detailsCartCard (clicked) {
  console.log("this is type of string and it is ", clicked);
  myDetails = (pants01.filter(mmod => { return mmod.name === clicked;}));
  myFunctionHide("checkoutCart");
  var x = 0;
  imgSelected = 0;
  console.log("This is myDetails", myDetails[0]);
  myFunctionShow("details");    
  buildProductDetailcard(myDetails,x,imgSelected);
}

// Event to show the Cart Items
const showCartItems = (event) => {
  myFunctionHide("details");
  myFunctionShow("checkoutCart");
  buildCartItems(shopCart);
}


// Remove Item from the cart -- There will be later add calculation for the total **
function removeItem(clicked){
  console.log(clicked);
  console.log("access to remove item");  
  var x = Number(clicked);
  for (i = 0; i < shopCart.length; i++) {
    if (x === shopCart[i].id) {
      var find = i;
    }
  }
  console.log(find);
  console.log("this lenght ",shopCart.length);
  if (shopCart.length === 1){
    shopCart.pop();
    //cartID = 0;
  } else {
    shopCart.splice(find, 1)[0];
  }
  
  console.log("this shop cart", shopCart);
  buildCartItems(shopCart);
}


// Click on Cart buttons to show the Cart Details. Also, you can checkout there.**
const filterModelCulotteEvent = (event) => {
  const buttonID = event.target.id;
  if (buttonID === 'historyCulotte') {
    const history = pants01.filter(mmod => {
      return mmod.model === "History Culotte";
    });
    myFunctionHide("details");
    myFunctionHide("checkoutCart");
    buildProductCard(history);
  } else if (buttonID === 'fashion') {
    const fashion = pants01.filter(mmod => {
      return mmod.model === "Fashion Culotte";
    });
    myFunctionHide("details");
    myFunctionHide("checkoutCart");
    buildProductCard(fashion);
  } else if (buttonID === 'all') {
    myFunctionHide("details");
    myFunctionHide("checkoutCart");
    buildProductCard(pants01);
  } else {
    //buildProductDetailcard(pants01);
  }
}

// *** End Shopping Page JS *** 

const history = [{
    imgUrl: 'https://www.traditioninaction.org/Questions/Images/L_005_ancien.jpg',
    altImg: 'French Revolutionaries',
    class: 'revCulottes',
    heading: 'French Revolutionaries inbetween 1789-1799',
    info: 'French revolutionary fighters were called sans-culottes due to the garb they wore.',
    imgClass: 'rev'
  },
  {
    imgUrl: 'https://silhouettetrends.files.wordpress.com/2014/04/0a3ce42990e2072e454ee245e38f121e.jpg',
    altImg: 'woman riding a bike in culottes',
    class: 'bikes',
    heading: 'Woman wearing culottes in 1930s.',
    info: 'Culottes made a come back in womens fashion in the 1930s as it allowed them do more physical things without worry of their skirt lifting.',
    imgClass: 'biker'
  },
  {
    imgUrl: 'https://i.ebayimg.com/images/g/yBEAAOSwqz9Zwh8Q/s-l1600.jpg',
    altImg: 'japanese male in a hakama',
    class: 'hakama',
    heading: 'Japanese Hakama',
    info: 'The japanese had their own form of culottes that were used to aid in horseback riding and hide their feet from opponents.',
    imgClass: 'japan'
  }
]

const historyCard = (hist) => {
  let cardString = '';

  for (let i = 0; i < hist.length; i++) {
    cardString += `
    <div class="col-3 col-md">
      <div class="card ${hist[i].class} historyCards" style="width: 18em;">
        <img class="card-img-top historyImg ${hist[i].imgClass}" src="${hist[i].imgUrl}" alt="${hist[i].altImg}">
        <div class="card-body">
          <h6 class="card-title historyTitle">${hist[i].heading}</h6>
          <p class="card-text hist-card">${hist[i].info}</p>
        </div>
      </div>
    </div>  
        `
  }
  printToDom('#historical', cardString);
}


let newsletter = []

const addEmail = (email) => {
  newsletter.push(email);
}

const generateAlert = (alertText, status) => {
  let domString = '';

  if (status === 'error') {
    domString += `<div class="alert alert-danger alert-dismissible fade show email-alert" role="alert">
      ${alertText}
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      </div>
      `;
  }

  if (status === 'success') {
    domString += `<div class="alert alert-success alert-dismissable fade show email-alert" role="alert">
      ${alertText}
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      </div>
    `;
  }

  printToDom('#emailAlert', domString)
}

const verifyEmail = (event) => {
  event.preventDefault();

  userEmail = document.getElementById('exampleInputEmail1').value;

  if (newsletter.includes(userEmail)) {

    text = 'Email Already Present';
    generateAlert(text, 'error');

  } else {
    addEmail(userEmail);
    text = "Welcome to the newsletter!"
    generateAlert(text, 'success');
  }
}


const clickEvents = () => {

  if (document.querySelector('#historyCulotte')) {
    document.querySelector('#historyCulotte').addEventListener('click', filterModelCulotteEvent);
  }

  if (document.querySelector('#fashion')) {
    document.querySelector('#fashion').addEventListener('click', filterModelCulotteEvent);
  }

  if (document.querySelector('#all')) {
    document.querySelector('#all').addEventListener('click', filterModelCulotteEvent);
  }

  if (document.querySelector('#cart')) {
    document.querySelector('#cart').addEventListener('click', showCartItems);
  }  

  if (document.querySelector('#inputEmail')) {
    document.querySelector('#inputEmail').addEventListener('click', verifyEmail);
  }
}

const about = [{
    line: 'We are diverse group of Culotte Aficionados that are here to educate the masses on the history of these majestic pants and revel in the recent revival of the Culotte in the modern fashion scene.'
  },
  {
    line: "PiÃ±a Culotte-a was created with the idea in mind of being a haven for those willing to experiment with their ensenble."
  },
  {
    line: "Here, you'll be amongst like minded fashionistas that share a fervent appreciation for history's greatest style of leg covers."
  },
  {
    line: "Whether you are a longtime fan of the split skirt wonder, or this is the first time you're being exposed to the truth of the Culotte, this site should aid in your education, appreciation, and acquisition of everything that is Culotte!"
  },
];

const aboutUsBuilder = (arr) => {
  let domString = '';

  for (let i = 0; i < arr.length; i++) {
    domString += `<p>${arr[i].line}</p>`;
  }

  printToDom('#aboutUs', domString);
}

const init = () => {
  aboutUsBuilder(about);
  buildProductCard(pants01);
  articleCardBuilder(articles);
  historyCard(history);
  printToDom("#previewCardContainer", previewCardBuilder(getImageURLs(pants01)));
  clickEvents();
}

init();